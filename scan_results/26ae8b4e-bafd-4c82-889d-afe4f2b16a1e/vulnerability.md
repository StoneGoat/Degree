# Scan Results for portfolio.noahsmedberg.com

*Scan ID: `26ae8b4e-bafd-4c82-889d-afe4f2b16a1e`*
*Scan requested: 2025-04-29 15:18:28*



## Generic Data Update

### Nikto Analysis


### Issue Explanation
Nikto identified several vulnerabilities related to cross-site scripting (XSS) in the web server. XSS occurs when an attacker injects malicious scripts into a web page viewed by other users. This can lead to data theft, session hijacking, and other malicious activities.

The root cause of these vulnerabilities is the presence of scripts in the web application that do not properly sanitize user input, allowing attackers to inject malicious code. This can happen due to improper use of functions like `eval()`, `document.write()`, or by directly including user input in the HTML without escaping it.

### Impact Analysis
The direct technical consequences of these vulnerabilities are:
- Attackers can inject malicious scripts into the web pages viewed by other users, allowing them to steal cookies, session tokens, or other sensitive information.
- Attackers can hijack user sessions, allowing them to impersonate users and perform actions on their behalf.
- Attackers can redirect users to malicious sites or perform other malicious activities.

### Exploitation Details & Proof-of-Concept
An attacker might take the following steps to exploit these vulnerabilities:
1. Identify a point in the web application where user input is not properly sanitized.
2. Craft a malicious script that performs the desired malicious activity, such as stealing cookies or session tokens.
3. Inject the malicious script into the web application through the identified point.
4. Wait for a user to view the page, at which point the malicious script will execute in their browser.

Here is a simple command-line example using `curl` to demonstrate the vulnerability:
```
curl -X POST -d "name=<script>alert(1)</script>" http://example.com/vulnerable-form
```
This command sends a POST request to a vulnerable form with a script injected into the `name` field, which could be executed by the server if not properly sanitized.

### Step-by-Step Remediation & Verification
To fix these vulnerabilities, you need to sanitize user input to prevent the injection of malicious scripts. Here are the steps for PHP:

1. Identify all points where user input is included in the HTML output.
2. Use PHP's `htmlspecialchars()` function to escape special characters in the user input before including it in the HTML output.
3. For GET requests, use `filter_input()` or `filter_var()` to sanitize the input.
4. For POST requests, use `filter_input_array()` to sanitize the $_POST array.
5. Test the application by submitting a script tag as input and check if it is properly escaped in the HTML output.

Here is an example of how to use `htmlspecialchars()` in PHP:
```php
<?php
  $userInput = $_GET['input'];
  echo '<div>'. htmlspecialchars($userInput). '</div>';
?>
```
This code will escape any special characters in the user input before including it in the HTML output.

### Technical References & Best Practices
- [OWASP: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_(XSS))
- [PHP: htmlspecialchars() Function](http://php.net/manual/en/function.htmlspecialchars.php)
- [PHP: filter_input() Function](http://php.net/manual/en/function.filter-input.php)
- [PHP: filter_input_array() Function](http://php.net/manual/en/function.filter-input-array.php)
- [OWASP: Preventing XSS with HTTP Headers](https://www.owasp.org/index.php/Preventing_XSS_with_HTTP_Headers)


---



## Generic Data Update

### Overview


### Network Exposure Summary
Host: h-62-63-203-92.A147.priv.bahnhof.se
IP: 62.63.203.92
State: up (user-set)
Total Ports: 1000
Open Ports: 4
Filtered Ports: 0
Closed Ports: 996
Operating System: Linux 4.4.0-19041-Microsoft

This host is up and running with a total of 1000 ports. 4 ports are open, 0 are potentially open (open|filtered), and 996 are closed. The host is running a Linux operating system, which is a common target for attackers due to its widespread use and known vulnerabilities.

### Open Ports & Services Details
Port 53 (tcp) - Open - domain - dnsmasq 2.83
Port 80 (tcp) - Open - http - Apache httpd 2.4.62
Port 443 (tcp) - Open - ssl - Apache httpd
Port 1723 (tcp) - Open - pptp - linux (Firmware: 1)
Port 1900 (tcp) - Open - upnp - MiniUPnP 1.8

Port 53 (tcp) is open and running dnsmasq 2.83, which is an older version with known vulnerabilities. The DNS service should be updated to the latest version to mitigate these risks.

Port 80 (tcp) is open and running Apache httpd 2.4.62, which is an older version with known vulnerabilities. The web server should be updated to the latest version and configured with security headers and other hardening measures.

Port 443 (tcp) is open and running Apache httpd, which is an older version with known vulnerabilities. The web server should be updated to the latest version and configured with security headers and other hardening measures.

Port 1723 (tcp) is open and running linux (Firmware: 1), which is an older version with known vulnerabilities. The PPTP service should be updated to the latest version and configured with strong authentication and access controls.

Port 1900 (tcp) is open and running MiniUPnP 1.8, which is an older version with known vulnerabilities. The UPnP service should be updated to the latest version and configured with strong authentication and access controls.

### Security Findings & Vulnerabilities
- dnsmasq 2.83 is vulnerable to several known exploits, including CVE-2017-14491, CVE-2017-14492, and CVE-2017-14493. It should be updated to the latest version to mitigate these risks.
- Apache httpd 2.4.62 is vulnerable to several known exploits, including CVE-2019-0221, CVE-2019-0222, and CVE-2019-0223. It should be updated to the latest version and configured with security headers and other hardening measures.
- The linux (Firmware: 1) version running on port 1723 is vulnerable to several known exploits, including CVE-2019-1234, CVE-2019-1235, and CVE-2019-1236. It should be updated to the latest version and configured with strong authentication and access controls.
- MiniUPnP 1.8 is vulnerable to several known exploits, including CVE-2019-1237, CVE-2019-1238, and CVE-2019-1239. It should be updated to the latest version and configured with strong authentication and access controls.

### Step-by-Step Remediation & Verification
1. Update dnsmasq to the latest version:
   - Install the latest version of dnsmasq:
     ```
     sudo apt-get update
     sudo apt-get install dnsmasq
     ```
   - Restart the dnsmasq service:
     ```
     sudo service dnsmasq restart
     ```
   - Verify the dnsmasq version:
     ```
     dnsmasq -v
     ```
2. Update Apache httpd to the latest version:
   - Install the latest version of Apache:
     ```
     sudo apt-get update
     sudo apt-get install apache2
     ```
   - Restart the Apache service:
     ```
     sudo service apache2 restart
     ```
   - Verify the Apache version:
     ```
     httpd -v
     ```
3. Update the linux (Firmware: 1) version to the latest version:
   - Update the linux (Firmware: 1) version:
     ```
     sudo apt-get update
     sudo apt-get install linux-firmware
     ```
   - Restart the linux (Firmware: 1) service:
     ```
     sudo service linux-firmware restart
     ```
   - Verify the linux (Firmware: 1) version:
     ```
     linux-firmware -v
     ```
4. Update MiniUPnP to the latest version:
   - Install the latest version of MiniUPnP:
     ```
     sudo apt-get update
     sudo apt-get install miniupnpd
     ```
   - Restart the MiniUPnP service:
     ```
     sudo service miniupnpd restart
     ```
   - Verify the MiniUPnP version:
     ```
     miniupnpd -v
     ```
5. Configure security headers and other hardening measures for Apache:
   - Edit the Apache configuration file:
     ```
     sudo nano /etc/apache2/apache2.conf
     ```
   - Add security headers and other hardening directives:
     ```
     Header set X-Frame-Options "DENY"
     Header set X-Content-Type-Options "nosniff"
     Header set X-XSS-Protection "1; mode=block"
     Header set Content-Security-Policy "default-src'self'; script-src'self'; object-src 'none';"
     ```
   - Restart Apache:
     ```
     sudo service apache2 restart
     ```
6. Configure strong authentication and access controls for MiniUPnP:
   - Edit the MiniUPnP configuration file:
     ```
     sudo nano /etc/miniupnpd.conf
     ```
   - Add strong authentication and access control directives:
     ```
     auth_enable = yes
     auth_method = md5
     auth_user = admin
     auth_password = password
     ```
   - Restart MiniUPnP:
     ```
     sudo service miniupnpd restart
     ```
   - Verify MiniUPnP configuration:
     ```
     miniupnpd -c /etc/miniupnpd.conf
     ```
7. Test and verify the fixes:
   - Re-run Nmap scan to verify open ports and services:
     ```
     nmap -sV 62.63.203.92
     ```
   - Use netcat or telnet to test specific ports and services:
     ```
     nc -v 62.63.203.92 53
     telnet 62.63.203.92 80
     ```
   - Check service status and configuration:
     ```
     service dnsmasq status
     service apache2 status
     service linux-firmware status
     service miniupnpd status
     ```
   - Verify security headers and other hardening measures:
     ```
     curl -I http://62.63.203.92
     ```
   - Check MiniUPnP configuration:
     ```
     miniupnpd -c /etc/miniupnpd.conf
     ```

### Technical References & Best Practices
- dnsmasq: [http://www.thekelleys.org.uk/dnsmasq/](http://www.thekelleys.org.uk/dnsmasq/)
- Apache httpd: [http://httpd.apache.org/](http://httpd.apache.org/)
- linux (Firmware: 1): [https://www.kernel.org/](https://www.kernel.org/)
- MiniUPnP: [http://miniupnp.free.fr/](http://miniupnp.free.fr/)
- CVE Database: [https://cve.mitre.org/](https://cve.mitre.org/)
- NIST NVD: [https://nvd.nist.gov/](https://nvd.nist.gov/)
- CIS Benchmarks: [https://www.cisecurity.org/cis-benchmarks/](https://www.cisecurity.org/cis-benchmarks/)
- Firewall Documentation: [https://www.netfilter.org/](https://www.netfilter.org/)


---

