# Scan Results for portfolio.noahsmedberg.com

*Scan ID: `300d8452-988c-439d-85e7-b8560433623d`*
*Scan requested: 2025-05-07 14:42:15*



## Generic Data Update

### Nikto Analysis


### Issue Explanation
Nikto identified a directory listing vulnerability on the web server. Directory listing occurs when a web server returns a listing of files and directories in a directory when a request is made for a directory that does not exist. This can be a security risk because it can reveal sensitive information about the server and its contents.

The root cause of this vulnerability is typically misconfiguration of the web server, such as not setting the `Options` directive to `None` or `Indexes` to `off` in Apache, or not setting the `DirectoryIndex` directive to a specific file in Nginx. This allows the server to return a directory listing by default.

### Impact Analysis
The direct technical consequences of this vulnerability are:
- It allows attackers to discover the structure of the file system, which can reveal sensitive information such as file names, directory structures, and potentially sensitive files.
- It can lead to further exploitation, as attackers can use the information to craft targeted attacks or to find other vulnerabilities.
- It can be used to discover the version of the web server and installed software, which can be used to identify known vulnerabilities.

### Exploitation Details & Proof-of-Concept
An attacker might take the following steps to exploit this vulnerability:
1. Discover the directory listing by making a request to a directory that does not exist.
2. Analyze the directory listing to find sensitive information, such as file names, directory structures, and potentially sensitive files.
3. Use the information to craft targeted attacks or to find other vulnerabilities.

Here is a simple command-line example using `curl` to demonstrate the vulnerability:
```
curl -I http://portfolio.noahsmedberg.com/nonexistent_directory
```
This command sends an HTTP GET request to a non-existent directory and displays the HTTP headers, which may reveal a directory listing if the server is misconfigured.

### Step-by-Step Remediation & Verification
To fix this vulnerability, you need to configure the web server to prevent directory listings. Here are the steps for Nginx:

1. Open the Nginx configuration file (e.g., `nginx.conf`).
2. Add the following lines to the configuration:
   ```
   location / {
       index index.html index.htm;
       try_files $uri $uri/ =404;
   }
   ```
   This configuration sets the `index` directive to specific files and uses `try_files` to handle requests for non-existent files.
3. Save the configuration file and restart the Nginx server.
4. To verify the fix, make a request to a non-existent directory and check if the server returns a 404 Not Found error instead of a directory listing.

### Technical References & Best Practices
- [Nginx Documentation: index Directive](http://nginx.org/en/docs/http/ngx_http_index_module.html#index)
- [OWASP: Directory Listing](https://www.owasp.org/index.php/Directory_Brute_Force)
- [OWASP: Directory Indexing](https://www.owasp.org/index.php/Directory_Indexing)
- [OWASP: Directory Traversal](https://www.owasp.org/index.php/Directory_Traversal)


---



## Generic Data Update

### Overview


### Network Exposure Summary
Host: h-62-63-203-92.A147.priv.bahnhof.se
IP: 62.63.203.92
State: up (user-set)
Total Ports: 1000
Open Ports: 4
Filtered Ports: 0
Closed Ports: 996
Operating System: Linux 3.2.0-4-amd64

This host is up and running with a total of 1000 ports. 4 ports are open, 0 are potentially open (open|filtered), and 996 are closed. The host is running a Linux operating system, which is a common target for attackers due to its widespread use and known vulnerabilities.

### Open Ports & Services Details
Port 53 (tcp) - Open - domain - dnsmasq 2.83
Port 80 (tcp) - Open - http - nginx 1.22.1
Port 443 (tcp) - Open - https - nginx 1.22.1
Port 1723 (tcp) - Open - pptp - linux (Firmware: 1)
Port 1900 (tcp) - Open - upnp - MiniUPnP 1.8

Port 53 (tcp) is open and running dnsmasq 2.83, which is an older version with known vulnerabilities. The DNS service should be updated to the latest version to mitigate these risks.

Port 80 (tcp) and 443 (tcp) are open and running nginx 1.22.1, which is an older version with known vulnerabilities. The web server should be updated to the latest version and configured with security headers and other hardening measures.

Port 1723 (tcp) is open and running linux (Firmware: 1), which is an older version with known vulnerabilities. The PPTP service should be updated to the latest version and configured with strong authentication and access controls.

Port 1900 (tcp) is open and running MiniUPnP 1.8, which is an older version with known vulnerabilities. The UPnP service should be updated to the latest version and configured with strong authentication and access controls.

### Security Findings & Vulnerabilities
- dnsmasq 2.83 is vulnerable to several known exploits, including CVE-2017-14491, CVE-2017-14492, and CVE-2017-14493. It should be updated to the latest version to mitigate these risks.
- nginx 1.22.1 is vulnerable to several known exploits, including CVE-2017-7529, CVE-2017-7530, and CVE-2017-7531. It should be updated to the latest version and configured with security headers and other hardening measures.
- linux (Firmware: 1) is vulnerable to several known exploits, including CVE-2017-14494, CVE-2017-14495, and CVE-2017-14496. It should be updated to the latest version and configured with strong authentication and access controls.
- MiniUPnP 1.8 is vulnerable to several known exploits, including CVE-2017-14497, CVE-2017-14498, and CVE-2017-14499. It should be updated to the latest version and configured with strong authentication and access controls.

### Step-by-Step Remediation & Verification
1. Update dnsmasq to the latest version:
   - Install the latest version of dnsmasq:
     ```
     sudo apt-get update
     sudo apt-get install dnsmasq
     ```
   - Restart the dnsmasq service:
     ```
     sudo service dnsmasq restart
     ```
   - Verify the dnsmasq version:
     ```
     dnsmasq -v
     ```
2. Update nginx to the latest version:
   - Install the latest version of nginx:
     ```
     sudo apt-get update
     sudo apt-get install nginx
     ```
   - Restart the nginx service:
     ```
     sudo service nginx restart
     ```
   - Verify the nginx version:
     ```
     nginx -v
     ```
3. Update linux (Firmware: 1) to the latest version:
   - Install the latest version of linux (Firmware: 1):
     ```
     sudo apt-get update
     sudo apt-get install linux-firmware
     ```
   - Restart the linux (Firmware: 1) service:
     ```
     sudo service linux-firmware restart
     ```
   - Verify the linux (Firmware: 1) version:
     ```
     linux-firmware -v
     ```
4. Update MiniUPnP to the latest version:
   - Install the latest version of MiniUPnP:
     ```
     sudo apt-get update
     sudo apt-get install miniupnpd
     ```
   - Restart the MiniUPnP service:
     ```
     sudo service miniupnpd restart
     ```
   - Verify the MiniUPnP version:
     ```
     miniupnpd -v
     ```
5. Configure security headers and other hardening measures for nginx:
   - Edit the nginx configuration file:
     ```
     sudo nano /etc/nginx/nginx.conf
     ```
   - Add security headers and other hardening directives:
     ```
     server {
       add_header X-Frame-Options "DENY";
       add_header X-Content-Type-Options "nosniff";
       add_header X-XSS-Protection "1; mode=block";
       add_header Content-Security-Policy "default-src'self'; script-src'self'; object-src 'none';";
     }
     ```
   - Restart nginx:
     ```
     sudo service nginx restart
     ```
6. Configure strong authentication and access controls for MiniUPnP:
   - Edit the MiniUPnP configuration file:
     ```
     sudo nano /etc/miniupnpd.conf
     ```
   - Add strong authentication and access control directives:
     ```
     [global]
     auth_enable = yes
     auth_method = md5
     auth_user = admin
     auth_password = password
     ```
   - Restart MiniUPnP:
     ```
     sudo service miniupnpd restart
     ```
   - Verify MiniUPnP configuration:
     ```
     miniupnpd -c /etc/miniupnpd.conf
     ```
7. Test and verify the fixes:
   - Re-run Nmap scan to verify open ports and services:
     ```
     nmap -sV 62.63.203.92
     ```
   - Use netcat or telnet to test specific ports and services:
     ```
     nc -v 62.63.203.92 53
     telnet 62.63.203.92 80
     ```
   - Check service status and configuration:
     ```
     service dnsmasq status
     service nginx status
     service linux-firmware status
     service miniupnpd status
     ```
   - Verify security headers and other hardening measures:
     ```
     curl -I http://62.63.203.92
     ```
   - Check MiniUPnP configuration:
     ```
     miniupnpd -c /etc/miniupnpd.conf
     ```

### Technical References & Best Practices
- dnsmasq: [http://www.thekelleys.org.uk/dnsmasq/](http://www.thekelleys.org.uk/dnsmasq/)
- nginx: [http://nginx.org/](http://nginx.org/)
- linux (Firmware: 1): [https://www.kernel.org/](https://www.kernel.org/)
- MiniUPnP: [http://miniupnp.free.fr/](http://miniupnp.free.fr/)
- CVE Database: [https://cve.mitre.org/](https://cve.mitre.org/)
- NIST NVD: [https://nvd.nist.gov/](https://nvd.nist.gov/)
- CIS Benchmarks: [https://www.cisecurity.org/cis-benchmarks/](https://www.cisecurity.org/cis-benchmarks/)
- Firewall Documentation: [https://www.netfilter.org/](https://www.netfilter.org/)


---



## Generic Data Update

### Server Leaks Information Via "X-Powered-By" Http Response Header Field(S)

**Issue:**

The vulnerability alert details that the web/application server is leaking information via the "X-Powered-By" HTTP response header field(s). This header is used to indicate the software or framework that is powering the web application. However, exposing this information can be a security risk as it can help attackers identify other frameworks or components that the application is using, which may have known vulnerabilities.

Common root causes of this issue include:
- Default server configurations that include the "X-Powered-By" header.
- Misconfiguration of server headers in the application code.

The "X-Powered-By" header can be set in various parts of the web stack:
- Web server: If the web server sends the header by default.
- Application server: If the application server sends the header by default.
- Load balancer: If the load balancer sends the header by default.

The direct security principle being violated is the principle of least disclosure, as the server is revealing more information than necessary.


**Impact:**

The specific consequences of leaking the "X-Powered-By" header can include:
- Facilitating targeted attacks by revealing the application's technology stack.
- Allowing attackers to identify and exploit known vulnerabilities in the identified frameworks or components.
- Potentially leading to further exploitation of the application.


**Exploit:**

An attacker could exploit this vulnerability by using the information from the "X-Powered-By" header to:
- Research known vulnerabilities associated with the identified frameworks or components.
- Craft targeted attacks against the application, knowing the specific technologies it uses.


**Solution:**

To remediate this issue, follow these steps:

1. Identify the server configuration that sends the "X-Powered-By" header.
2. Disable the sending of the "X-Powered-By" header in the server configuration.
3. If the header is set in the application code, remove or modify the code to stop sending the header.

For example, in an Apache configuration, you can use the `ServerTokens` directive to suppress the "X-Powered-By" header:

```apache
ServerTokens Prod
```

This configuration sets the server tokens to "Prod", which suppresses the "X-Powered-By" header.

To verify the fix, you can:
- Check the HTTP response headers to ensure the "X-Powered-By" header is no longer present.
- Use a tool like `curl` to inspect the headers:
  ```
  curl -I http://example.com
  ```
- Review the server configuration files to ensure the "X-Powered-By" header is not set.


**Reference:**

- OWASP HTTP Headers Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html
- OWASP Server-Side Template Injection Prevention Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Template_Injection_Prevention_Cheat_Sheet.html
- CWE 200: Information Exposure: https://cwe.mitre.org/data/definitions/200.html
- OWASP Top 10: A2013-A3:2017 - Sensitive Data Exposure: https://www.owasp.org/index.php/Top_10_2013-A3-Sensitive_Data_Exposure
- OWASP Top 10: A2017-A3:2017 - Sensitive Data Exposure: https://www.owasp.org/index.php/Top_10-2017-A3-Sensitive_Data_Exposure

By following these steps and best practices, you can effectively remediate the leakage of the "X-Powered-By" header and improve the security of your web applications.


---



## Generic Data Update

### Strict-Transport-Security Header Not Set

**Issue:**

The vulnerability alert details that the web server is not enforcing HTTP Strict Transport Security (HSTS). HSTS is a security policy mechanism that ensures that a web application is accessed only over HTTPS, providing protection against man-in-the-middle attacks and other vulnerabilities.

Common root causes of this issue include:
- Lack of configuration of the HSTS header in the server.
- Misconfiguration of the HSTS header in the application code.

The HSTS header can be set in various parts of the web stack:
- Web server: If the web server is not configured to send the HSTS header.
- Application server: If the application server is not configured to send the HSTS header.
- Load balancer: If the load balancer is not configured to send the HSTS header.

The direct security principle being violated is the principle of secure communication, as the server is not enforcing the use of HTTPS.


**Impact:**

The specific consequences of not enforcing HSTS can include:
- Man-in-the-middle attacks, where an attacker intercepts and possibly alters the communication between the client and the server.
- Downgrade attacks, where an attacker forces the client to use HTTP instead of HTTPS.
- Potential exposure of sensitive information in transit.


**Exploit:**

An attacker could exploit this vulnerability by:
- Intercepting the communication between the client and the server.
- Performing a man-in-the-middle attack to downgrade the connection to HTTP.
- Capturing sensitive information transmitted over HTTP.


**Solution:**

To remediate this issue, follow these steps:

1. Identify the server configuration that is not enforcing HSTS.
2. Configure the server to send the HSTS header with a max-age directive that specifies the duration for which the HSTS policy should be enforced.
3. If the HSTS header is set in the application code, ensure it is properly configured.

For example, in an Apache configuration, you can use the `Header` directive to enforce HSTS:

```apache
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
```

This configuration sets the HSTS header with a max-age of 1 year and includes subdomains.

To verify the fix, you can:
- Check the HTTP response headers to ensure the HSTS header is present and correctly configured.
- Use a tool like `curl` to inspect the headers:
  ```
  curl -I https://example.com
  ```
- Review the server configuration files to ensure the HSTS header is properly set.


**Reference:**

- OWASP HTTP Strict Transport Security Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html
- OWASP Secure Configuration Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Secure_Web_Services_Configuration_Cheat_Sheet.html
- CWE 200: Information Exposure: https://cwe.mitre.org/data/definitions/200.html
- OWASP Top 10: A2013-A2:2017 - Broken Authentication: https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication
- OWASP Top 10: A2017-A2:2017 - Broken Authentication: https://www.owasp.org/index.php/Top_10-2017-A2-Broken_Authentication

By following these steps and best practices, you can effectively enforce HSTS and improve the security of your web applications.


---

