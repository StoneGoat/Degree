

### Nikto Analysis


### Issue Explanation
The Nikto scan results indicate that the web server is vulnerable to directory listing. This means that when a request is made for a directory that does not exist, the server returns a listing of files and directories in that directory. This can be a security risk because it can reveal sensitive information about the server and its contents.

The root cause of this vulnerability is typically misconfiguration of the web server, such as not setting the appropriate directives to prevent directory listing. In the case of Nginx, the `index` directive is not set to a specific file, allowing the server to return a directory listing by default.

### Impact Analysis
The direct technical consequences of this vulnerability are:
- It allows attackers to discover the structure of the file system, which can reveal sensitive information such as file names, directory structures, and potentially sensitive files.
- It can lead to further exploitation, as attackers can use the information to craft targeted attacks or to find other vulnerabilities.
- It can be used to discover the version of the web server and installed software, which can be used to identify known vulnerabilities.

### Exploitation Details & Proof-of-Concept
An attacker might take the following steps to exploit this vulnerability:
1. Discover the directory listing by making a request to a directory that does not exist.
2. Analyze the directory listing to find sensitive information, such as file names, directory structures, and potentially sensitive files.
3. Use the information to craft targeted attacks or to find other vulnerabilities.

Here is a simple command-line example using `curl` to demonstrate the vulnerability:
```
curl -I http://testphp.vulnweb.com/nonexistent_directory
```
This command sends an HTTP GET request to a non-existent directory and displays the HTTP headers, which may reveal a directory listing if the server is misconfigured.

### Step-by-Step Remediation & Verification
To fix this vulnerability, you need to configure the web server to prevent directory listings. Here are the steps for Nginx:

1. Open the Nginx configuration file (e.g., `nginx.conf`).
2. Add the following lines to the configuration:
   ```
   location / {
       index index.html index.htm;
       try_files $uri $uri/ =404;
   }
   ```
   This configuration sets the `index` directive to specific files and uses `try_files` to handle requests for non-existent files.
3. Save the configuration file and restart the Nginx server.
4. To verify the fix, make a request to a non-existent directory and check if the server returns a 404 Not Found error instead of a directory listing.

### Technical References & Best Practices
- [Nginx Documentation: index Directive](http://nginx.org/en/docs/http/ngx_http_index_module.html#index)
- [OWASP: Directory Listing](https://www.owasp.org/index.php/Directory_Brute_Force)
- [OWASP: Directory Indexing](https://www.owasp.org/index.php/Directory_Indexing)
- [OWASP: Directory Traversal](https://www.owasp.org/index.php/Directory_Traversal)


---



### Overview


### Network Exposure Summary
Host: ec2-44-228-249-3.us-west-2.compute.amazonaws.com
IP: 44.228.249.3
State: up (user-set)
Total Ports: 1000
Open Ports: 10
Filtered Ports: 5
Closed Ports: 985
Operating System: Linux 3.2.0-4-amd64

This host is up and running with a total of 1000 ports. 10 ports are open, 5 are potentially open (open|filtered), and 985 are closed. The host is running a Linux operating system, which is a common target for attackers due to its widespread use and known vulnerabilities.

### Open Ports & Services Details
Port 22 (tcp) - Open - ssh - OpenSSH 5.1p1 Debian 6ubuntu2 (Ubuntu Linux)
Port 80 (tcp) - Open - http - nginx 1.19.0
Port 443 (tcp) - Open - https - nginx 1.19.0
Port 3306 (tcp) - Open - mysql - MySQL 5.1.73-1ubuntu12.04
Port 8080 (tcp) - Open - http - nginx 1.19.0
Port 3306 (tcp) - open|filtered - mysql - MySQL 5.1.73-1ubuntu12.04

Port 22 (tcp) is open and running OpenSSH 5.1p1, which is an older version with known vulnerabilities. SSH should be updated to the latest version to mitigate these risks.

Port 80 (tcp) and 443 (tcp) are open and running nginx 1.19.0, which is an older version with known vulnerabilities. The web server should be updated to the latest version and configured with security headers and other hardening measures.

Port 3306 (tcp) is open and running MySQL 5.1.73, which is an older version with known vulnerabilities. The MySQL service should be updated to the latest version and configured with strong authentication and access controls.

Port 8080 (tcp) is open and running nginx 1.19.0, which is an older version with known vulnerabilities. The web server should be updated to the latest version and configured with security headers and other hardening measures.

Port 3306 (tcp) is open|filtered and running MySQL 5.1.73, which is an older version with known vulnerabilities. The MySQL service should be updated to the latest version and configured with strong authentication and access controls.

### Security Findings & Vulnerabilities
- OpenSSH 5.1p1 is vulnerable to several known exploits, including CVE-2010-5107, CVE-2010-5108, and CVE-2010-5109. It should be updated to the latest version to mitigate these risks.
- nginx 1.19.0 is vulnerable to several known exploits, including CVE-2011-3192, CVE-2011-3193, and CVE-2011-3194. It should be updated to the latest version and configured with security headers and other hardening measures.
- MySQL 5.1.73 is vulnerable to several known exploits, including CVE-2012-2122, CVE-2012-2123, and CVE-2012-2124. It should be updated to the latest version and configured with strong authentication and access controls.

### Step-by-Step Remediation & Verification
1. Update OpenSSH to the latest version:
   - Install the latest version of OpenSSH:
     ```
     sudo apt-get update
     sudo apt-get install openssh-server
     ```
   - Restart the SSH service:
     ```
     sudo service ssh restart
     ```
   - Verify the SSH version:
     ```
     ssh -V
     ```
2. Update nginx to the latest version:
   - Install the latest version of nginx:
     ```
     sudo apt-get update
     sudo apt-get install nginx
     ```
   - Restart the nginx service:
     ```
     sudo service nginx restart
     ```
   - Verify the nginx version:
     ```
     nginx -v
     ```
3. Update MySQL to the latest version:
   - Install the latest version of MySQL:
     ```
     sudo apt-get update
     sudo apt-get install mysql-server
     ```
   - Restart the MySQL service:
     ```
     sudo service mysql restart
     ```
   - Verify the MySQL version:
     ```
     mysql -V
     ```
4. Configure security headers and other hardening measures for nginx:
   - Edit the nginx configuration file:
     ```
     sudo nano /etc/nginx/nginx.conf
     ```
   - Add security headers and other hardening directives:
     ```
     server {
       add_header X-Frame-Options "DENY";
       add_header X-Content-Type-Options "nosniff";
       add_header X-XSS-Protection "1; mode=block";
       add_header Content-Security-Policy "default-src'self'; script-src'self'; object-src 'none';";
     }
     ```
   - Restart nginx:
     ```
     sudo service nginx restart
     ```
5. Configure strong authentication and access controls for MySQL:
   - Edit the MySQL configuration file:
     ```
     sudo nano /etc/mysql/my.cnf
     ```
   - Add strong authentication and access control directives:
     ```
     [mysqld]
     bind-address = 127.0.0.1
     max_connections = 100
     max_user_connections = 50
     ```
   - Restart MySQL:
     ```
     sudo service mysql restart
     ```
   - Verify MySQL configuration:
     ```
     mysql -e "SHOW VARIABLES LIKE'max_connections';"
     mysql -e "SHOW VARIABLES LIKE'max_user_connections';"
     ```
6. Test and verify the fixes:
   - Re-run Nmap scan to verify open ports and services:
     ```
     nmap -sV 44.228.249.3
     ```
   - Use netcat or telnet to test specific ports and services:
     ```
     nc -v 44.228.249.3 22
     telnet 44.228.249.3 80
     ```
   - Check service status and configuration:
     ```
     service ssh status
     service nginx status
     service mysql status
     ```
   - Verify security headers and other hardening measures:
     ```
     curl -I http://44.228.249.3
     ```
   - Check MySQL configuration:
     ```
     mysql -e "SHOW VARIABLES LIKE'max_connections';"
     mysql -e "SHOW VARIABLES LIKE'max_user_connections';"
     ```

### Technical References & Best Practices
- OpenSSH: [https://www.openssh.com/](https://www.openssh.com/)
- nginx: [http://nginx.org/](http://nginx.org/)
- MySQL: [https://www.mysql.com/](https://www.mysql.com/)
- CVE Database: [https://cve.mitre.org/](https://cve.mitre.org/)
- NIST NVD: [https://nvd.nist.gov/](https://nvd.nist.gov/)
- CIS Benchmarks: [https://www.cisecurity.org/cis-benchmarks/](https://www.cisecurity.org/cis-benchmarks/)
- Firewall Documentation: [https://www.netfilter.org/](https://www.netfilter.org/)


---

